<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0F0F0F">
    <title>EventRaze - Temukan Event di Solo</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #0F0F0F;
            --secondary: #F7C566;
            --bg-light: #FFFFFF;
            --bg-dark: #1a1a1a;
            --text-light: #333333;
            --text-dark: #E5E5E5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-light);
            transition: background-color 0.3s, color 0.3s;
            padding-bottom: 80px;
        }

        body.dark-mode {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
        }

        .btn-primary {
            background-color: var(--secondary);
            border: none;
            color: var(--primary);
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            border-radius: 12px;
            padding: 12px 24px;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background-color: #e5b555;
            color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(247, 197, 102, 0.3);
        }

        .btn-secondary {
            background-color: #666;
            border: none;
            color: white;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            border-radius: 12px;
        }

        /* Navigation Bar */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--primary);
            padding: 12px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        body.dark-mode .bottom-nav {
            background: #000;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-icon {
            font-size: 24px;
            color: #666;
            transition: all 0.3s;
            display: inline-block;
        }

        .nav-item.active .nav-icon {
            color: var(--secondary);
            transform: translateY(-5px) scale(1.1);
        }

        .nav-label {
            display: block;
            font-size: 11px;
            color: #999;
            margin-top: 4px;
            font-family: 'Poppins', sans-serif;
        }

        .nav-item.active .nav-label {
            color: var(--secondary);
        }

        /* Page Container */
        .page {
            display: none;
            animation: fadeIn 0.3s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Auth Pages */
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .auth-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            max-width: 450px;
            width: 100%;
        }

        body.dark-mode .auth-card {
            background: #2a2a2a;
        }

        .logo-text {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 10px;
        }

        body.dark-mode .logo-text {
            color: var(--secondary);
        }

        .form-control {
            border-radius: 10px;
            padding: 12px;
            border: 1px solid #ddd;
        }

        body.dark-mode .form-control {
            background: #1a1a1a;
            border-color: #444;
            color: var(--text-dark);
        }

        /* Event Cards */
        .event-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: all 0.3s;
            cursor: pointer;
            margin-bottom: 20px;
            position: relative;
        }

        body.dark-mode .event-card {
            background: #2a2a2a;
        }

        .event-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .event-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .event-content {
            padding: 16px;
        }

        .event-category {
            display: inline-block;
            background: var(--secondary);
            color: var(--primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .bookmark-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
            z-index: 10;
        }

        .bookmark-btn:hover {
            transform: scale(1.1);
        }

        .bookmark-btn.active {
            background: var(--secondary);
        }

        .bookmark-btn.active i {
            color: var(--primary);
        }

        /* Megaphone Animation */
        .megaphone-container {
            text-align: center;
            padding: 30px;
            margin: 20px 0;
        }

        .megaphone {
            font-size: 80px;
            display: inline-block;
            animation: shake 2s infinite;
        }

        @keyframes shake {
            0%, 100% { transform: rotate(0deg); }
            10%, 30%, 50%, 70%, 90% { transform: rotate(-10deg); }
            20%, 40%, 60%, 80% { transform: rotate(10deg); }
        }

        /* Search Bar */
        .search-bar {
            position: relative;
            margin: 20px 0;
        }

        .search-bar input {
            width: 100%;
            padding: 14px 50px 14px 20px;
            border-radius: 30px;
            border: 2px solid #eee;
            font-size: 15px;
        }

        body.dark-mode .search-bar input {
            background: #2a2a2a;
            border-color: #444;
            color: var(--text-dark);
        }

        .search-bar i {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        /* Category Pills */
        .category-pills {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
            scrollbar-width: none;
        }

        .category-pills::-webkit-scrollbar {
            display: none;
        }

        .category-pill {
            padding: 8px 20px;
            border-radius: 20px;
            border: 2px solid var(--secondary);
            background: transparent;
            color: var(--secondary);
            font-size: 14px;
            font-weight: 600;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-pill.active {
            background: var(--secondary);
            color: var(--primary);
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 999;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: rotate(180deg);
        }

        .theme-toggle i {
            font-size: 20px;
            color: var(--primary);
        }

        /* Profile Page */
        .profile-header {
            text-align: center;
            padding: 30px 0;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: var(--primary);
            margin: 0 auto 15px;
            position: relative;
            overflow: hidden;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            background: var(--secondary);
            border: 3px solid white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        body.dark-mode .camera-btn {
            border-color: #2a2a2a;
        }

        .list-group-item {
            border-radius: 12px;
            margin-bottom: 8px;
            border: 1px solid #eee;
        }

        body.dark-mode .list-group-item {
            background: #2a2a2a;
            border-color: #444;
            color: var(--text-dark);
        }

        body.dark-mode .list-group-item:hover {
            background: #333;
        }

        /* Chat/Forum */
        .chat-container {
            height: calc(100vh - 250px);
            overflow-y: auto;
            padding: 20px;
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
        }

        .chat-message.own {
            flex-direction: row-reverse;
        }

        .chat-bubble {
            background: #f0f0f0;
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 70%;
        }

        body.dark-mode .chat-bubble {
            background: #2a2a2a;
        }

        .chat-message.own .chat-bubble {
            background: var(--secondary);
            color: var(--primary);
        }

        .chat-input-container {
            position: fixed;
            bottom: 80px;
            left: 0;
            right: 0;
            padding: 15px;
            background: white;
            border-top: 1px solid #eee;
        }

        body.dark-mode .chat-input-container {
            background: var(--bg-dark);
            border-top-color: #333;
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: red;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
        }

        /* Notification Card */
        .notification-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.3s;
        }

        body.dark-mode .notification-card {
            background: #2a2a2a;
        }

        .notification-card:hover {
            transform: translateX(5px);
        }

        .notification-card.unread {
            border-left: 4px solid var(--secondary);
        }

        /* Modal Customization */
        .modal-content {
            border-radius: 20px;
            border: none;
        }

        body.dark-mode .modal-content {
            background: #2a2a2a;
            color: var(--text-dark);
        }

        body.dark-mode .modal-header {
            border-bottom-color: #444;
        }

        body.dark-mode .modal-footer {
            border-top-color: #444;
        }

        body.dark-mode .btn-close {
            filter: invert(1);
        }

        .container-custom {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            margin: 25px 0 15px;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }

        .empty-state i {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .certificate-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        body.dark-mode .certificate-card {
            background: #2a2a2a;
        }
    </style>
</head>
<body>
    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">
        <i class="bi bi-moon-fill" id="themeIcon"></i>
    </button>

    <!-- Login Page -->
    <div id="loginPage" class="page active">
        <div class="auth-container">
            <div class="auth-card">
                <div class="text-center mb-4">
                    <div class="logo-text">EventRaze</div>
                    <p class="text-muted">Temukan Event Menarik di Solo</p>
                </div>
                <form onsubmit="login(event)">
                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="loginEmail" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="loginPassword" required>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="rememberMe">
                        <label class="form-check-label" for="rememberMe">Ingat Saya</label>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 mb-3">Masuk</button>
                    <div class="text-center">
                        <a href="#" onclick="showForgotPassword(); return false;" class="text-decoration-none" style="color: var(--secondary)">Lupa Password?</a>
                    </div>
                    <hr>
                    <div class="text-center">
                        <span>Belum punya akun? </span>
                        <a href="#" onclick="showRegister(); return false;" class="text-decoration-none" style="color: var(--secondary)">Daftar</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Register Page -->
    <div id="registerPage" class="page">
        <div class="auth-container">
            <div class="auth-card">
                <div class="text-center mb-4">
                    <div class="logo-text">Buat Akun</div>
                    <p class="text-muted">Bergabung dengan EventRaze</p>
                </div>
                <form onsubmit="register(event)">
                    <div class="mb-3">
                        <label class="form-label">Nama Lengkap</label>
                        <input type="text" class="form-control" id="registerName" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="registerEmail" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="registerPassword" required minlength="6">
                        <small class="text-muted">Minimal 6 karakter</small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Konfirmasi Password</label>
                        <input type="password" class="form-control" id="registerPasswordConfirm" required>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 mb-3">Daftar</button>
                    <div class="text-center">
                        <span>Sudah punya akun? </span>
                        <a href="#" onclick="showLogin(); return false;" class="text-decoration-none" style="color: var(--secondary)">Masuk</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Home Page -->
    <div id="homePage" class="page">
        <div class="container-custom">
            <div class="megaphone-container">
                <div class="megaphone">ðŸ“¢</div>
                <h2 class="mt-3">Jangan Lewatkan Event Seru!</h2>
                <p class="text-muted">Temukan berbagai event menarik di sekitar Solo</p>
            </div>

            <div class="search-bar">
                <input type="text" placeholder="Cari event..." id="searchInput" oninput="searchEvents()">
                <i class="bi bi-search"></i>
            </div>

            <div class="category-pills" id="categoryPills"></div>

            <h3 class="section-title">Event Terbaru</h3>
            <div id="eventList"></div>
        </div>
    </div>

    <!-- Reminder/Notification Page -->
    <div id="reminderPage" class="page">
        <div class="container-custom">
            <h2 class="section-title">Pengingat & Notifikasi</h2>
            <div id="notificationList"></div>
        </div>
    </div>

    <!-- Profile Page -->
    <div id="profilePage" class="page">
        <div class="container-custom">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar">
                    <i class="bi bi-person-fill"></i>
                    <div class="camera-btn" onclick="document.getElementById('photoInput').click()">
                        <i class="bi bi-camera-fill"></i>
                    </div>
                    <input type="file" id="photoInput" accept="image/*" style="display:none" onchange="uploadPhoto(event)">
                </div>
                <h3 id="profileName">User</h3>
                <p class="text-muted" id="profileEmail">user@email.com</p>
            </div>

            <div class="list-group mb-4">
                <a href="#" class="list-group-item list-group-item-action" onclick="showEditProfile(); return false;">
                    <i class="bi bi-pencil-square me-2"></i> Edit Profile
                </a>
                <a href="#" class="list-group-item list-group-item-action" onclick="showBookmarks(); return false;">
                    <i class="bi bi-bookmark-fill me-2"></i> Bookmark Event
                </a>
                <a href="#" class="list-group-item list-group-item-action" onclick="showHistory(); return false;">
                    <i class="bi bi-clock-history me-2"></i> Riwayat Event
                </a>
                <a href="#" class="list-group-item list-group-item-action" onclick="showCertificates(); return false;">
                    <i class="bi bi-award-fill me-2"></i> Sertifikat Digital
                </a>
                <a href="#" class="list-group-item list-group-item-action" onclick="showLanguageSettings(); return false;">
                    <i class="bi bi-translate me-2"></i> Bahasa
                </a>
                <a href="#" class="list-group-item list-group-item-action text-danger" onclick="logout(); return false;">
                    <i class="bi bi-box-arrow-right me-2"></i> Keluar
                </a>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="d-flex">
            <div class="nav-item active" onclick="showPage('home')">
                <i class="bi bi-house-fill nav-icon"></i>
                <span class="nav-label">Home</span>
            </div>
            <div class="nav-item" onclick="showPage('reminder')">
                <div style="position: relative; display: inline-block;">
                    <i class="bi bi-bell-fill nav-icon"></i>
                    <span class="notification-badge" id="notifBadge" style="display: none;">0</span>
                </div>
                <span class="nav-label">Reminder</span>
            </div>
            <div class="nav-item" onclick="showPage('profile')">
                <i class="bi bi-person-fill nav-icon"></i>
                <span class="nav-label">Profile</span>
            </div>
        </div>
    </div>

    <!-- Event Detail Modal -->
    <div class="modal fade" id="eventDetailModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalEventTitle"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="modalEventBody"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-primary" onclick="joinEvent()">Beli Tiket</button>
                    <button type="button" class="btn btn-primary" onclick="openChat()">Chat Forum</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Modal -->
    <div class="modal fade" id="chatModal" tabindex="-1">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="chatEventTitle">Forum Chat</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="chat-container" id="chatContainer"></div>
                </div>
                <div class="chat-input-container">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Ketik pesan..." id="chatInput" onkeypress="if(event.key==='Enter') sendMessage()">
                        <button class="btn btn-primary" onclick="sendMessage()">
                            <i class="bi bi-send-fill"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal fade" id="editProfileModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editProfileForm">
                        <div class="mb-3">
                            <label class="form-label">Nama</label>
                            <input type="text" class="form-control" id="editName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="editEmail" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" onclick="saveProfile()">Simpan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bookmarks Modal -->
    <div class="modal fade" id="bookmarksModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Bookmark Event</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="bookmarksBody"></div>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div class="modal fade" id="historyModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Riwayat Event</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="historyBody"></div>
            </div>
        </div>
    </div>

    <!-- Certificates Modal -->
    <div class="modal fade" id="certificatesModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Sertifikat Digital</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="certificatesBody"></div>
            </div>
        </div>
    </div>

    <!-- Language Modal -->
    <div class="modal fade" id="languageModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Pilih Bahasa</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="list-group">
                        <a href="#" class="list-group-item list-group-item-action active">
                            <i class="bi bi-check-circle-fill me-2"></i> Bahasa Indonesia
                        </a>
                        <a href="#" class="list-group-item list-group-item-action">
                            English
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div class="modal fade" id="forgotPasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Lupa Password</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Masukkan email Anda untuk reset password:</p>
                    <input type="email" class="form-control" id="forgotEmail" placeholder="Email">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" onclick="resetPassword()">Kirim</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global Variables
        let currentUser = null;
        let currentEvent = null;
        let currentCategory = 'Semua';
        let events = [];
        let bookmarks = [];
        let history = [];
        let notifications = [];
        let chatMessages = {};

        // Categories
        const categories = ['Semua', 'Musik', 'Olahraga', 'Teknologi', 'Seni', 'Kuliner', 'Edukasi', 'Sosial'];

        // Sample Events
        const sampleEvents = [
            {
                id: 1,
                title: 'Solo Jazz Festival 2025',
                category: 'Musik',
                date: '2025-01-15',
                time: '19:00',
                location: 'Balekambang Park',
                price: 'Rp 150.000',
                quota: 500,
                registered: 234,
                image: 'https://images.unsplash.com/photo-1514320291840-2e0a9bf2a9ae?w=500',
                description: 'Festival jazz terbesar di Solo dengan berbagai musisi ternama dari dalam dan luar negeri. Nikmati malam yang penuh harmoni musik jazz.'
            },
            {
                id: 2,
                title: 'Solo Marathon 2025',
                category: 'Olahraga',
                date: '2025-02-20',
                time: '06:00',
                location: 'Stadion Manahan',
                price: 'Rp 200.000',
                quota: 1000,
                registered: 567,
                image: 'https://images.unsplash.com/photo-1532444458054-01a7dd3e9fca?w=500',
                description: 'Maraton internasional dengan rute menyusuri kota Solo yang indah. Tersedia kategori 5K, 10K, Half Marathon, dan Full Marathon.'
            },
            {
                id: 3,
                title: 'Tech Conference Solo',
                category: 'Teknologi',
                date: '2025-01-25',
                time: '09:00',
                location: 'UNS Convention Center',
                price: 'Gratis',
                quota: 300,
                registered: 189,
                image: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=500',
                description: 'Konferensi teknologi dengan pembicara dari berbagai perusahaan startup dan tech giant. Pelajari tren teknologi terkini.'
            },
            {
                id: 4,
                title: 'Pameran Seni Rupa',
                category: 'Seni',
                date: '2025-02-10',
                time: '10:00',
                location: 'Galeri Seni Solo',
                price: 'Rp 50.000',
                quota: 200,
                registered: 78,
                image: 'https://images.unsplash.com/photo-1561214115-f2f134cc4912?w=500',
                description: 'Pameran karya seni dari seniman lokal dan nasional. Eksplorasi berbagai aliran seni rupa kontemporer dan tradisional.'
            },
            {
                id: 5,
                title: 'Festival Kuliner Nusantara',
                category: 'Kuliner',
                date: '2025-01-18',
                time: '16:00',
                location: 'Alun-alun Kidul',
                price: 'Gratis',
                quota: 2000,
                registered: 1234,
                image: 'https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=500',
                description: 'Festival kuliner dengan berbagai makanan khas dari seluruh Indonesia. Nikmati cita rasa nusantara dalam satu tempat.'
            }
        ];

        // Initialize App
        window.onload = function() {
            initializeApp();
        };

        function initializeApp() {
            // Load data
            events = JSON.parse(localStorage.getItem('eventraze_events') || JSON.stringify(sampleEvents));
            bookmarks = JSON.parse(localStorage.getItem('eventraze_bookmarks') || '[]');
            history = JSON.parse(localStorage.getItem('eventraze_history') || '[]');
            notifications = JSON.parse(localStorage.getItem('eventraze_notifications') || '[]');
            chatMessages = JSON.parse(localStorage.getItem('eventraze_chats') || '{}');

            // Add sample notifications
            if (notifications.length === 0) {
                notifications = [
                    { id: 1, title: 'Event Baru!', message: 'Solo Jazz Festival 2025 sudah dibuka!', date: new Date().toISOString(), read: false },
                    { id: 2, title: 'Pengingat', message: 'Tech Conference Solo besok pukul 09:00', date: new Date().toISOString(), read: false },
                    { id: 3, title: 'Info', message: 'Jangan lupa cek event terbarumu!', date: new Date().toISOString(), read: true }
                ];
                localStorage.setItem('eventraze_notifications', JSON.stringify(notifications));
            }

            // Check session
            const session = JSON.parse(localStorage.getItem('eventraze_session') || 'null');
            if (session && session.email) {
                const users = JSON.parse(localStorage.getItem('eventraze_users') || '[]');
                const user = users.find(u => u.email === session.email);
                if (user) {
                    currentUser = user;
                    showMainApp();
                    return;
                }
            }

            // Apply theme
            const savedTheme = localStorage.getItem('eventraze_theme') || 'light';
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                document.getElementById('themeIcon').className = 'bi bi-sun-fill';
            }
        }

        // Auth Functions
        function register(e) {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerPasswordConfirm').value;

            if (password !== confirmPassword) {
                alert('Password tidak cocok!');
                return;
            }

            if (password.length < 6) {
                alert('Password minimal 6 karakter!');
                return;
            }

            let users = JSON.parse(localStorage.getItem('eventraze_users') || '[]');
            
            if (users.find(u => u.email === email)) {
                alert('Email sudah terdaftar!');
                return;
            }

            const newUser = {
                name: name,
                email: email,
                password: btoa(password),
                photo: null,
                language: 'id',
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('eventraze_users', JSON.stringify(users));

            alert('Registrasi berhasil! Silakan login.');
            showLogin();
        }

        function login(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;

            const users = JSON.parse(localStorage.getItem('eventraze_users') || '[]');
            const user = users.find(u => u.email === email && u.password === btoa(password));

            if (!user) {
                alert('Email atau password salah!');
                return;
            }

            currentUser = user;
            
            if (rememberMe) {
                localStorage.setItem('eventraze_session', JSON.stringify({ email: user.email }));
            }

            showMainApp();
        }

        function logout() {
            if (confirm('Yakin ingin keluar?')) {
                localStorage.removeItem('eventraze_session');
                currentUser = null;
                location.reload();
            }
        }

        function showLogin() {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('loginPage').classList.add('active');
        }

        function showRegister() {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('registerPage').classList.add('active');
        }

        function showForgotPassword() {
            const modal = new bootstrap.Modal(document.getElementById('forgotPasswordModal'));
            modal.show();
        }

        function resetPassword() {
            const email = document.getElementById('forgotEmail').value;
            if (!email) {
                alert('Masukkan email!');
                return;
            }
            alert('Link reset password telah dikirim ke ' + email);
            bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal')).hide();
        }

        function showMainApp() {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('homePage').classList.add('active');
            
            // Update profile
            updateProfile();
            
            // Load home content
            loadCategories();
            loadEvents();
            updateNotificationBadge();
        }

        // Navigation
        function showPage(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));

            if (page === 'home') {
                document.getElementById('homePage').classList.add('active');
                document.querySelectorAll('.nav-item')[0].classList.add('active');
                loadEvents();
            } else if (page === 'reminder') {
                document.getElementById('reminderPage').classList.add('active');
                document.querySelectorAll('.nav-item')[1].classList.add('active');
                loadNotifications();
            } else if (page === 'profile') {
                document.getElementById('profilePage').classList.add('active');
                document.querySelectorAll('.nav-item')[2].classList.add('active');
                updateProfile();
            }
        }

        // Theme
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            document.getElementById('themeIcon').className = isDark ? 'bi bi-sun-fill' : 'bi bi-moon-fill';
            localStorage.setItem('eventraze_theme', isDark ? 'dark' : 'light');
        }

        // Categories
        function loadCategories() {
            const container = document.getElementById('categoryPills');
            container.innerHTML = categories.map(cat => 
                `<div class="category-pill ${cat === currentCategory ? 'active' : ''}" onclick="filterByCategory('${cat}')">${cat}</div>`
            ).join('');
        }

        function filterByCategory(category) {
            currentCategory = category;
            loadCategories();
            loadEvents();
        }

        // Events
        function loadEvents() {
            const container = document.getElementById('eventList');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            let filteredEvents = events;
            
            if (currentCategory !== 'Semua') {
                filteredEvents = filteredEvents.filter(e => e.category === currentCategory);
            }
            
            if (searchTerm) {
                filteredEvents = filteredEvents.filter(e => 
                    e.title.toLowerCase().includes(searchTerm) || 
                    e.description.toLowerCase().includes(searchTerm)
                );
            }

            if (filteredEvents.length === 0) {
                container.innerHTML = '<div class="empty-state"><i class="bi bi-inbox"></i><p>Tidak ada event ditemukan</p></div>';
                return;
            }

            container.innerHTML = filteredEvents.map(event => {
                const isBookmarked = bookmarks.includes(event.id);
                return `
                    <div class="event-card" onclick="showEventDetail(${event.id})">
                        <button class="bookmark-btn ${isBookmarked ? 'active' : ''}" onclick="toggleBookmark(${event.id}); event.stopPropagation();">
                            <i class="bi ${isBookmarked ? 'bi-bookmark-fill' : 'bi-bookmark'}"></i>
                        </button>
                        <img src="${event.image}" alt="${event.title}" class="event-image">
                        <div class="event-content">
                            <span class="event-category">${event.category}</span>
                            <h5 class="mb-2">${event.title}</h5>
                            <p class="text-muted mb-2"><i class="bi bi-calendar3"></i> ${formatDate(event.date)} - ${event.time}</p>
                            <p class="text-muted mb-2"><i class="bi bi-geo-alt-fill"></i> ${event.location}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <strong>${event.price}</strong>
                                <small class="text-muted">${event.registered}/${event.quota} peserta</small>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function searchEvents() {
            loadEvents();
        }

        function toggleBookmark(eventId) {
            const index = bookmarks.indexOf(eventId);
            if (index > -1) {
                bookmarks.splice(index, 1);
            } else {
                bookmarks.push(eventId);
            }
            localStorage.setItem('eventraze_bookmarks', JSON.stringify(bookmarks));
            loadEvents();
        }

        function showEventDetail(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) return;

            currentEvent = event;
            
            document.getElementById('modalEventTitle').textContent = event.title;
            document.getElementById('modalEventBody').innerHTML = `
                <img src="${event.image}" class="img-fluid rounded mb-3" alt="${event.title}">
                <span class="event-category mb-3">${event.category}</span>
                <h6 class="mt-3">Deskripsi</h6>
                <p>${event.description}</p>
                <h6 class="mt-3">Detail Event</h6>
                <p><i class="bi bi-calendar3"></i> <strong>Tanggal:</strong> ${formatDate(event.date)}</p>
                <p><i class="bi bi-clock"></i> <strong>Waktu:</strong> ${event.time} WIB</p>
                <p><i class="bi bi-geo-alt-fill"></i> <strong>Lokasi:</strong> ${event.location}</p>
                <p><i class="bi bi-tag-fill"></i> <strong>Harga:</strong> ${event.price}</p>
                <p><i class="bi bi-people-fill"></i> <strong>Kuota:</strong> ${event.registered}/${event.quota} peserta</p>
            `;

            const modal = new bootstrap.Modal(document.getElementById('eventDetailModal'));
            modal.show();
        }

        function joinEvent() {
            if (!currentEvent) return;

            if (currentEvent.registered >= currentEvent.quota) {
                alert('Maaf, kuota sudah penuh!');
                return;
            }

            if (confirm(`Beli tiket untuk ${currentEvent.title}?`)) {
                // Update registered count
                currentEvent.registered++;
                
                // Add to history
                const historyItem = {
                    ...currentEvent,
                    joinedAt: new Date().toISOString(),
                    status: 'upcoming'
                };
                
                if (!history.find(h => h.id === currentEvent.id)) {
                    history.push(historyItem);
                    localStorage.setItem('eventraze_history', JSON.stringify(history));
                }

                // Update events
                localStorage.setItem('eventraze_events', JSON.stringify(events));

                // Add notification
                notifications.unshift({
                    id: Date.now(),
                    title: 'Pembelian Berhasil!',
                    message: `Tiket untuk ${currentEvent.title} berhasil dibeli`,
                    date: new Date().toISOString(),
                    read: false
                });
                localStorage.setItem('eventraze_notifications', JSON.stringify(notifications));
                updateNotificationBadge();

                alert('Pembelian tiket berhasil!');
                bootstrap.Modal.getInstance(document.getElementById('eventDetailModal')).hide();
                loadEvents();
            }
        }

        function openChat() {
            if (!currentEvent) return;

            document.getElementById('chatEventTitle').textContent = `Forum - ${currentEvent.title}`;
            
            // Load chat messages
            loadChatMessages();

            bootstrap.Modal.getInstance(document.getElementById('eventDetailModal')).hide();
            const chatModal = new bootstrap.Modal(document.getElementById('chatModal'));
            chatModal.show();
        }

        function loadChatMessages() {
            if (!currentEvent) return;

            const eventChats = chatMessages[currentEvent.id] || [];
            const container = document.getElementById('chatContainer');

            if (eventChats.length === 0) {
                container.innerHTML = '<div class="empty-state"><i class="bi bi-chat-dots"></i><p>Belum ada pesan. Mulai percakapan!</p></div>';
                return;
            }

            container.innerHTML = eventChats.map(msg => `
                <div class="chat-message ${msg.userId === currentUser.email ? 'own' : ''}">
                    <div class="chat-bubble">
                        <strong>${msg.userName}</strong><br>
                        ${msg.message}<br>
                        <small class="text-muted">${formatTime(msg.time)}</small>
                    </div>
                </div>
            `).join('');

            container.scrollTop = container.scrollHeight;
        }

        function sendMessage() {
            if (!currentEvent) return;

            const input = document.getElementById('chatInput');
            const message = input.value.trim();

            if (!message) return;

            if (!chatMessages[currentEvent.id]) {
                chatMessages[currentEvent.id] = [];
            }

            chatMessages[currentEvent.id].push({
                userId: currentUser.email,
                userName: currentUser.name,
                message: message,
                time: new Date().toISOString()
            });

            localStorage.setItem('eventraze_chats', JSON.stringify(chatMessages));

            input.value = '';
            loadChatMessages();
        }

        // Notifications
        function loadNotifications() {
            const container = document.getElementById('notificationList');

            if (notifications.length === 0) {
                container.innerHTML = '<div class="empty-state"><i class="bi bi-bell-slash"></i><p>Tidak ada notifikasi</p></div>';
                return;
            }

            container.innerHTML = notifications.map(notif => `
                <div class="notification-card ${!notif.read ? 'unread' : ''}" onclick="markAsRead(${notif.id})">
                    <h6>${notif.title}</h6>
                    <p class="mb-1">${notif.message}</p>
                    <small class="text-muted">${formatDate(notif.date)}</small>
                </div>
            `).join('');
        }

        function markAsRead(notifId) {
            const notif = notifications.find(n => n.id === notifId);
            if (notif) {
                notif.read = true;
                localStorage.setItem('eventraze_notifications', JSON.stringify(notifications));
                loadNotifications();
                updateNotificationBadge();
            }
        }

        function updateNotificationBadge() {
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notifBadge');
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        // Profile
        function updateProfile() {
            if (!currentUser) return;

            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileEmail').textContent = currentUser.email;

            const avatar = document.getElementById('profileAvatar');
            if (currentUser.photo) {
                avatar.innerHTML = `<img src="${currentUser.photo}" alt="Profile"><div class="camera-btn" onclick="document.getElementById('photoInput').click()"><i class="bi bi-camera-fill"></i></div>`;
            } else {
                avatar.innerHTML = `<i class="bi bi-person-fill"></i><div class="camera-btn" onclick="document.getElementById('photoInput').click()"><i class="bi bi-camera-fill"></i></div>`;
            }
        }

        function uploadPhoto(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                currentUser.photo = e.target.result;
                
                // Update in storage
                const users = JSON.parse(localStorage.getItem('eventraze_users') || '[]');
                const userIndex = users.findIndex(u => u.email === currentUser.email);
                if (userIndex > -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem('eventraze_users', JSON.stringify(users));
                }

                updateProfile();
            };
            reader.readAsDataURL(file);
        }

        function showEditProfile() {
            document.getElementById('editName').value = currentUser.name;
            document.getElementById('editEmail').value = currentUser.email;
            
            const modal = new bootstrap.Modal(document.getElementById('editProfileModal'));
            modal.show();
        }

        function saveProfile() {
            const newName = document.getElementById('editName').value;
            const newEmail = document.getElementById('editEmail').value;

            if (!newName || !newEmail) {
                alert('Nama dan email harus diisi!');
                return;
            }

            currentUser.name = newName;
            currentUser.email = newEmail;

            // Update in storage
            const users = JSON.parse(localStorage.getItem('eventraze_users') || '[]');
            const userIndex = users.findIndex(u => u.email === currentUser.email);
            if (userIndex > -1) {
                users[userIndex] = currentUser;
                localStorage.setItem('eventraze_users', JSON.stringify(users));
            }

            // Update session
            localStorage.setItem('eventraze_session', JSON.stringify({ email: currentUser.email }));

            updateProfile();
            bootstrap.Modal.getInstance(document.getElementById('editProfileModal')).hide();
            alert('Profile berhasil diupdate!');
        }

        function showBookmarks() {
            const bookmarkedEvents = events.filter(e => bookmarks.includes(e.id));
            const container = document.getElementById('bookmarksBody');

            if (bookmarkedEvents.length === 0) {
                container.innerHTML = '<div class="empty-state"><i class="bi bi-bookmark"></i><p>Belum ada bookmark</p></div>';
            } else {
                container.innerHTML = bookmarkedEvents.map(event => `
                    <div class="event-card" onclick="showEventDetail(${event.id})">
                        <img src="${event.image}" alt="${event.title}" class="event-image">
                        <div class="event-content">
                            <span class="event-category">${event.category}</span>
                            <h5 class="mb-2">${event.title}</h5>
                            <p class="text-muted mb-2"><i class="bi bi-calendar3"></i> ${formatDate(event.date)}</p>
                            <p class="text-muted mb-2"><i class="bi bi-geo-alt-fill"></i> ${event.location}</p>
                        </div>
                    </div>
                `).join('');
            }

            const modal = new bootstrap.Modal(document.getElementById('bookmarksModal'));
            modal.show();
        }

        function showHistory() {
            const container = document.getElementById('historyBody');

            if (history.length === 0) {
                container.innerHTML = '<div class="empty-state"><i class="bi bi-clock-history"></i><p>Belum ada riwayat event</p></div>';
            } else {
                container.innerHTML = history.map(event => `
                    <div class="event-card">
                        <img src="${event.image}" alt="${event.title}" class="event-image">
                        <div class="event-content">
                            <span class="event-category">${event.category}</span>
                            <h5 class="mb-2">${event.title}</h5>
                            <p class="text-muted mb-2"><i class="bi bi-calendar3"></i> ${formatDate(event.date)}</p>
                            <p class="text-muted mb-2"><i class="bi bi-geo-alt-fill"></i> ${event.location}</p>
                            <span class="badge bg-success">Terdaftar</span>
                        </div>
                    </div>
                `).join('');
            }

            const modal = new bootstrap.Modal(document.getElementById('historyModal'));
            modal.show();
        }

        function showCertificates() {
            const completedEvents = history.filter(h => new Date(h.date) < new Date());
            const container = document.getElementById('certificatesBody');

            if (completedEvents.length === 0) {
                container.innerHTML = '<div class="empty-state"><i class="bi bi-award"></i><p>Belum ada sertifikat</p></div>';
            } else {
                container.innerHTML = completedEvents.map(event => `
                    <div class="certificate-card">
                        <h6>${event.title}</h6>
                        <p class="text-muted mb-2">${formatDate(event.date)}</p>
                        <button class="btn btn-primary btn-sm" onclick="downloadCertificate(${event.id})">
                            <i class="bi bi-download"></i> Download Sertifikat
                        </button>
                    </div>
                `).join('');
            }

            const modal = new bootstrap.Modal(document.getElementById('certificatesModal'));
            modal.show();
        }

        function downloadCertificate(eventId) {
            alert('Sertifikat akan diunduh. Fitur ini akan segera tersedia!');
        }

        function showLanguageSettings() {
            const modal = new bootstrap.Modal(document.getElementById('languageModal'));
            modal.show();
        }

        // Utility Functions
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('id-ID', options);
        }

        function formatTime(timeStr) {
            const date = new Date(timeStr);
            return date.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
        }
    </script>
</body>
</html>